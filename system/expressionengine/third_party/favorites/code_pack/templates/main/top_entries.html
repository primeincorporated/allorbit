{embed="%prefix%inc/index" page_title="Top Entries"}
	</head>

	<body role="document">

{embed="%prefix%inc/header" page="entry"}

		<div class="container" style="margin-top:30px;">

			<div class="page-header">
				<h1>Top Entries</h1>
				<p class="lead">Below is a ranked list of entries for this site, which allows you to see the most favorited entries for this site.</p>
			</div>

			<div class="row">
				<div class="col-sm-8">
{if segment_3 == "collection"}
					<div class="alert alert-info" role="alert">
						<p class="lead">Currently filtered by the <strong>{segment_4}</strong> collection.</p>
					</div>
{/if}
					{exp:favorites:rank_entries
						orderby="total_favorites" sort="desc"
						limit="10"
						paginate="bottom"
					{if segment_3 == "collection"}
						collection="{segment_4}"
					{/if}
					}
					<h3><a href="{url_title_path='%prefix%main/entry'}">{title}</a> &nbsp;<small class="text-danger"><span class="glyphicon glyphicon-heart" aria-hidden="true"></span> {favorites:total_favorites}</small></h3>
					<p>
					{if body}
						{body}
					{if:else}
						<div class="alert alert-warning" role="alert">
							No <b>body</b> field available. You'll need to either rename this field to one that exists on
							your site, or create a new field called 'body' for this field to work.
						</div>
					{/if}
					</p>
{embed="%prefix%inc/favorites_info" type="entry" id="{entry_id}"}
					{!-- Begin Testing and Debugging --}
					<div class="panel panel-default solspace-debug">
						<div class="panel-heading">
							<h3 class="panel-title">Channel Entry Testing &amp; Debugging</h3>
						</div>
						<div class="panel-body">
							<ul>
								<li>Entry ID: {entry_id}</li>
								<li>URL Title: {url_title}</li>
								<li>Count: {favorites:count}</li>
								<li>Total Results: {favorites:total_results}</li>
								<li>Absolute Count: {favorites:absolute_count}</li>
								<li>Absolute Results: {favorites:absolute_results}</li>
							</ul>
						</div>
					</div>
					{!-- End Testing and Debugging --}
					<hr />
					{if no_results}
						<div class="alert alert-warning" role="alert">
 							<p><strong>Sorry, no channel entries were found.</strong> If you continue to have trouble getting channel entries to display, make sure that:</p>
							<ul>
								<li>Channel entries exist for your site.</li>
								<li>At least one channel entry has been saved to a members' favorites.</li>
								<li>If any of your entries have a status other than <i>closed</i>, have <i>future</i> entry dates, are <i>expired</i>, etc, you'll need to include the necessary parameters on the <i>Favorites:Rank_Entries</i> loop for this template.</li>
							</ul>
						</div>
					{/if}
					{favorites:paginate}
						<ul class="pagination pagination-lg">
						{favorites:pagination_links}
						{first_page}
							<li><a href="{pagination_url}">First</a></li>
						{/first_page}
						{previous_page}
							<li><a href="{pagination_url}">&laquo; Previous</a></li>
						{/previous_page}
						{page}
							<li{if current_page} class="active"{/if}><a href="{pagination_url}">{pagination_page_number}</a></li>
						{/page}
						{next_page}
							<li><a href="{pagination_url}">Next &raquo;</a></li>
						{/next_page}
						{last_page}
							<li><a href="{pagination_url}">Last</a></li>
						{/last_page}
						{/favorites:pagination_links}
						</ul>
					{/favorites:paginate}
					{/exp:favorites:rank_entries}
				</div>

				<div class="col-sm-4">				
{embed="%prefix%inc/sidebar"}
				</div>
      		</div>

			<div class="well" style="margin-top:30px;">
				<h2 style="margin-top:5px;">About This Page</h2>
				<p>The "Top Entries" page displays a ranked list of entries, which allows you to see the most favorited entries for this site. It is also set up to look for a collection name in the URI and if present, will filter the entry results down to ones that are saved to that collection.</p>
				<p>It makes use of the following tags:</p>
				<ul>
					<li><a href="http://solspace.com/docs/favorites/rank_entries/">Favorites:Rank_Entries</a> to display a ranked list of most favorited entries for the site.</li>
					<li><a href="http://solspace.com/docs/favorites/info/">Favorites:Info</a> to display and handle formatting of favorites info and adding/updating/removing favorites functionality for the currently logged in user.</li>
					<li><a href="http://solspace.com/docs/favorites/form/">Favorites:Form</a> to allow the currently logged in user to add an entry to their favorites.</li>
					<li><a href="http://solspace.com/docs/favorites/edit/">Favorites:Edit</a> to allow the currently logged in user to update or remove an entry from their favorites.</li>
				</ul>
				<p>The global sidebar on the right makes use of the following tags:</p>
				<ul>
					<li><a href="http://solspace.com/docs/favorites/collections/">Favorites:Collections</a> filtered by type (entry/member), to display a list of all the currently available Favorites collections for the site.</li>
					<li><a href="http://solspace.com/docs/favorites/entries/">Favorites:Entries</a> to display the saved favorited entries of the currently logged in user.</li>
					<li><a href="http://solspace.com/docs/favorites/members/">Favorites:Members</a> to display the saved favorited members of the currently logged in user.</li>
				</ul>
			</div>

{embed="%prefix%inc/footer"}